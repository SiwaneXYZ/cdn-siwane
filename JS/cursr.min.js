
function generateCursor() {
  // نقرأ اللون الحالي من المتغير --linkC
  const linkC = getComputedStyle(document.documentElement).getPropertyValue('--linkC').trim();

  // نرسم SVG جديد باللون الحالي
  const svg = `
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0,0,256,256" width="${cursor_config.cursor_width}" height="${cursor_config.cursor_height}">
      <path transform="scale(10.66667,10.66667)"
            d="M20.83,15.831c-0.12,0.41-0.47,0.71-0.89,0.77l-7.51,1.18l-5.63,4.66c-0.2,0.16-0.45,0.25-0.7,0.25c-0.16,0-0.32,-0.03-0.47,-0.11c-0.38,-0.18-0.63,-0.57-0.63,-0.99v-18.23c0,-0.43 0.26,-0.83 0.65,-1c0.39,-0.18 0.86,-0.11 1.18,0.18l13.68,12.15c0.31,0.29 0.44,0.73 0.32,1.14z"
            stroke="${linkC}" stroke-width="${cursor_config.border_width}" stroke-linejoin="round" fill="${linkC}"/>
    </svg>`;

  // نولّد data URI جديد
  const cursorURI = `url('data:image/svg+xml;utf8,${encodeURIComponent(svg)}') 0 0, auto`;

  // نحدّث الـ style
  let styleEl = document.querySelector("#dynamic-cursor-style");
  if (!styleEl) {
    styleEl = document.createElement("style");
    styleEl.id = "dynamic-cursor-style";
    document.head.appendChild(styleEl);
  }
  styleEl.textContent = `* { cursor: ${cursorURI} !important; }`;
}

document.addEventListener("DOMContentLoaded", function () {
  generateCursor();

  // مراقبة تغييرات class أو style على body (مثل drK)
  const observer = new MutationObserver(() => generateCursor());
  observer.observe(document.body, { attributes: true, attributeFilter: ["class", "style"] });
});
