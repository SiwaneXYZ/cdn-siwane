function decryptText(encryptedText,key){try{const decodedBase64=atob(encryptedText);const decrypted=CryptoJS.AES.decrypt(decodedBase64,key).toString(CryptoJS.enc.Utf8);return decrypted;}catch(e){return null;}}const secretKey="Rawan05@*#$";function verifyDomain(){const decryptedText=decryptText(encryptedBase64.activationCode,secretKey);if(decryptedText){const currentDomain=window.location.hostname;const cleanDecryptedText=decryptedText.replace(/^www\./,'');const cleanCurrentDomain=currentDomain.replace(/^www\./,'');if(cleanCurrentDomain===cleanDecryptedText){protectedCode(encryptedBase64.customSettings);}else{showErrorNotification("naming");}}else{showErrorNotification("key");}}function protectedCode(config){console.log("تم التحقق بنجاح! الإعدادات المخصصة:",config);if(config.enableFeature){console.log("تم تفعيل خاصية معينة بناءً على الإعدادات.");}function base64Decode(encoded){try{return atob(encoded);}catch(error){console.error('خطأ في فك تشفير Base64:',error);return null;}}function decodeUrlParameter(){const urlParams=new URLSearchParams(window.location.search);const encodedUrl=urlParams.get('url');if(!encodedUrl){console.error('لم يتم توفير رابط مشفر.');showError('لم يتم توفير رابط.');return null;}const decodedUrl=base64Decode(encodedUrl);if(!decodedUrl){console.error('خطأ في فك تشفير الرابط.');showError('الرابط غير صالح.');return null;}console.log('الرابط المفكوك:',decodedUrl);return decodedUrl;}function handleDecodedUrl(){const decodedUrl=decodeUrlParameter();if(!decodedUrl)return;try{const urlDomain=new URL(decodedUrl).hostname.replace(/^www\./,'');if(config.allowedDomains.includes(urlDomain)){const iframe=document.getElementById('myIframe');if(iframe){iframe.src=decodedUrl;console.log('تم تحميل الرابط داخل الإطار:',decodedUrl);}else{console.error('iframe غير موجود.');showError('تعذر تحميل الرابط.');}}else{console.error('النطاق غير مسموح به:',urlDomain);showError('النطاق غير مسموح به.');}}catch(error){console.error('خطأ في معالجة الرابط:',error);showError('تعذر معالجة الرابط.');}}function showError(message){const messageElement=document.getElementById('noUrlMessage');if(messageElement){messageElement.style.display='flex';messageElement.innerText=message;}}const closeButton=document.getElementById('closeButton');if(closeButton){closeButton.addEventListener('click',function(){if(window.history.length>1){history.back();}else{window.location.href='/';}});}handleDecodedUrl()}function showErrorNotification(errorType){const overlay=document.createElement("div");overlay.className="overlay";const notification=document.createElement("div");notification.className="notification-error";if(errorType==="key"){notification.innerHTML=`<p>خطأ: رمز التفعيل غير صحيح!</p><a href="https://wa.me/212722464243?text=مشكلة في رمز التفعيل" class="support-link">اتصل بالدعم</a>`;}else if(errorType==="naming"){notification.innerHTML=`<p>خطأ: النطاق الحالي غير مدعوم!</p><a href="https://wa.me/212722464243?text=مشكلة في النطاق" class="support-link">اتصل بالدعم</a>`;}document.body.appendChild(overlay);document.body.appendChild(notification);}verifyDomain();const style=`.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(255,255,255,0.7);z-index:999;backdrop-filter:blur(5px);}.notification-error{background-color:#f8d7da;color:#721c24;padding:20px;text-align:center;border-radius:10px;box-shadow:0 0 15px rgba(0,0,0,0.2);font-weight:bold;font-size:18px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);animation:slideIn 0.5s ease-in-out;z-index:1000;width:80%;max-width:500px;}.support-link{display:block;margin-top:15px;padding:10px;background-color:#25d366;color:white;text-decoration:none;font-weight:bold;border-radius:5px;text-align:center;}.support-link:hover{background-color:#128c7e;}@keyframes slideIn{from{transform:translate(-50%,-60%);opacity:0;}to{transform:translate(-50%,-50%);opacity:1;}}`;const styleSheet=document.createElement("style");styleSheet.type="text/css";styleSheet.innerText=style;document.head.appendChild(styleSheet);
